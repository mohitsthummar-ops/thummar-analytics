<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thummar Analytics - Turning Data into Decisions</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: '#5ebec4',
            bgLight: '#fdf5df',
            primaryDark: '#4da8a8',
            bgDark: '#f8f0d0'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            display: ['Outfit', 'system-ui', 'sans-serif']
          }
        }
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=Outfit:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    @keyframes countUp {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }
    .animate-slide-in { animation: slideIn 0.4s ease-out forwards; }
    .animate-pulse-slow { animation: pulse 2s ease-in-out infinite; }
    .animate-count { animation: countUp 0.5s ease-out forwards; }
    .animate-float { animation: float 3s ease-in-out infinite; }
    .skeleton {
      background: linear-gradient(90deg, #e0e0e0 25%, #f0f0f0 50%, #e0e0e0 75%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
    }
    .dark .skeleton {
      background: linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%);
      background-size: 200% 100%;
    }
    .chart-container { position: relative; height: 280px; }
    .sidebar-transition { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-4px); box-shadow: 0 12px 40px -12px rgba(94, 190, 196, 0.3); }
    .glass-effect {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    .dark .glass-effect {
      background: rgba(31, 41, 55, 0.8);
      border: 1px solid rgba(75, 85, 99, 0.3);
    }
    .gradient-text {
      background: linear-gradient(135deg, #5ebec4 0%, #4da8a8 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .btn-primary {
      background: linear-gradient(135deg, #5ebec4 0%, #4da8a8 100%);
      transition: all 0.3s ease;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px -8px rgba(94, 190, 196, 0.5);
    }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
    ::-webkit-scrollbar-thumb { background: #5ebec4; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #4da8a8; }
    .dark ::-webkit-scrollbar-track { background: #374151; }
  </style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-bgLight dark:bg-gray-900 font-sans overflow-auto">
  <div id="app" class="h-full w-full"></div>
  <script>
    // ==================== STATE MANAGEMENT ====================
    const store = {
      state: {
        isAuthenticated: false,
        currentUser: null,
        currentView: 'landing',
        darkMode: false,
        sidebarOpen: true,
        selectedDateRange: '30d',
        selectedMetric: 'revenue',
        searchQuery: '',
        loading: true,
        notifications: [],
        kpiData: [],
        chartData: null,
        tableData: [],
        users: []
      },
      listeners: [],
      subscribe(fn) { this.listeners.push(fn); },
      notify() { this.listeners.forEach(fn => fn(this.state)); },
      setState(newState) {
        this.state = { ...this.state, ...newState };
        this.notify();
      }
    };

    // ==================== MOCK DATA ====================
    const mockUsers = [
      { id: 1, email: 'admin@thummar.com', password: 'admin123', name: 'Thummar Admin', role: 'admin', avatar: 'üë®‚Äçüíº' },
      { id: 2, email: 'manager@thummar.com', password: 'manager123', name: 'Sarah Manager', role: 'manager', avatar: 'üë©‚Äçüíª' },
      { id: 3, email: 'viewer@thummar.com', password: 'viewer123', name: 'John Viewer', role: 'viewer', avatar: 'üë§' }
    ];

    const generateKPIData = () => [
      { id: 1, title: 'Total Revenue', value: Math.floor(Math.random() * 500000) + 1000000, change: (Math.random() * 20 - 5).toFixed(1), prefix: '$', icon: 'üí∞', color: 'from-emerald-400 to-emerald-600' },
      { id: 2, title: 'Total Orders', value: Math.floor(Math.random() * 5000) + 10000, change: (Math.random() * 15 - 3).toFixed(1), icon: 'üì¶', color: 'from-blue-400 to-blue-600' },
      { id: 3, title: 'Active Users', value: Math.floor(Math.random() * 2000) + 5000, change: (Math.random() * 25 - 8).toFixed(1), icon: 'üë•', color: 'from-purple-400 to-purple-600' },
      { id: 4, title: 'Conversion Rate', value: (Math.random() * 3 + 2).toFixed(2), change: (Math.random() * 10 - 2).toFixed(1), suffix: '%', icon: 'üìà', color: 'from-orange-400 to-orange-600' },
      { id: 5, title: 'Avg Order Value', value: Math.floor(Math.random() * 50) + 120, change: (Math.random() * 12 - 4).toFixed(1), prefix: '$', icon: 'üõí', color: 'from-pink-400 to-pink-600' },
      { id: 6, title: 'Customer Retention', value: (Math.random() * 10 + 85).toFixed(1), change: (Math.random() * 8 - 2).toFixed(1), suffix: '%', icon: 'üîÑ', color: 'from-cyan-400 to-cyan-600' },
      { id: 7, title: 'New Customers', value: Math.floor(Math.random() * 500) + 1200, change: (Math.random() * 30 - 5).toFixed(1), icon: 'üÜï', color: 'from-indigo-400 to-indigo-600' },
      { id: 8, title: 'Inventory Items', value: Math.floor(Math.random() * 1000) + 3500, change: (Math.random() * 5 - 1).toFixed(1), icon: 'üìã', color: 'from-amber-400 to-amber-600' }
    ];

    const generateChartData = () => {
      const labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      return {
        labels,
        revenue: labels.map(() => Math.floor(Math.random() * 100000) + 50000),
        orders: labels.map(() => Math.floor(Math.random() * 2000) + 500),
        customers: labels.map(() => Math.floor(Math.random() * 500) + 200),
        categories: ['Electronics', 'Clothing', 'Home & Garden', 'Sports', 'Books'],
        categoryValues: [35, 25, 20, 12, 8]
      };
    };

    const generateTableData = () => {
      const products = ['Laptop Pro X', 'Wireless Earbuds', 'Smart Watch Elite', 'Gaming Console', 'Tablet Air', '4K Monitor', 'Mechanical Keyboard', 'Webcam HD'];
      const statuses = ['Completed', 'Processing', 'Shipped', 'Pending'];
      return Array.from({ length: 50 }, (_, i) => ({
        id: i + 1,
        orderNumber: `ORD-${String(Math.floor(Math.random() * 90000) + 10000)}`,
        customer: ['Alice Johnson', 'Bob Smith', 'Carol White', 'David Brown', 'Eva Martinez', 'Frank Lee', 'Grace Kim', 'Henry Chen'][Math.floor(Math.random() * 8)],
        product: products[Math.floor(Math.random() * products.length)],
        amount: Math.floor(Math.random() * 2000) + 100,
        status: statuses[Math.floor(Math.random() * statuses.length)],
        date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString(),
        trend: Array.from({ length: 7 }, () => Math.random() * 100)
      }));
    };

    // ==================== UTILITY FUNCTIONS ====================
    const formatNumber = (num, prefix = '', suffix = '') => {
      if (num >= 1000000) return prefix + (num / 1000000).toFixed(1) + 'M' + suffix;
      if (num >= 1000) return prefix + (num / 1000).toFixed(1) + 'K' + suffix;
      return prefix + num.toLocaleString() + suffix;
    };

    const hasPermission = (permission) => {
      const user = store.state.currentUser;
      if (!user) return false;
      const permissions = {
        admin: ['dashboard', 'sales', 'customers', 'inventory', 'users', 'settings', 'export', 'filters'],
        manager: ['dashboard', 'sales', 'customers', 'export', 'filters'],
        viewer: ['dashboard', 'sales', 'customers']
      };
      return permissions[user.role]?.includes(permission) || false;
    };

    const showNotification = (message, type = 'success') => {
      const id = Date.now();
      const notifications = [...store.state.notifications, { id, message, type }];
      store.setState({ notifications });
      setTimeout(() => {
        store.setState({ notifications: store.state.notifications.filter(n => n.id !== id) });
      }, 3000);
    };

    const exportToCSV = () => {
      if (!hasPermission('export')) {
        showNotification('You do not have permission to export', 'error');
        return;
      }
      const data = store.state.tableData;
      const headers = ['Order Number', 'Customer', 'Product', 'Amount', 'Status', 'Date'];
      const csv = [headers.join(','), ...data.map(row => 
        [row.orderNumber, row.customer, row.product, row.amount, row.status, row.date].join(',')
      )].join('\n');
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'thummar-analytics-export.csv';
      a.click();
      URL.revokeObjectURL(url);
      showNotification('CSV exported successfully!');
    };

    const exportToPDF = () => {
      if (!hasPermission('export')) {
        showNotification('You do not have permission to export', 'error');
        return;
      }
      showNotification('PDF export initiated. In production, this would generate a PDF report.');
    };

    // ==================== COMPONENTS ====================
    const renderLandingPage = () => `
      <div class="min-h-full bg-gradient-to-br from-bgLight via-white to-bgDark dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">
        <!-- Navigation -->
        <nav class="glass-effect fixed top-0 left-0 right-0 z-50 px-6 py-4">
          <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-primaryDark flex items-center justify-center text-white font-bold text-xl">T</div>
              <span class="font-display font-bold text-xl text-gray-800 dark:text-white" id="brand-name">Thummar Analytics</span>
            </div>
            <div class="flex items-center gap-4">
              <button onclick="toggleDarkMode()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <span class="text-xl">${store.state.darkMode ? '‚òÄÔ∏è' : 'üåô'}</span>
              </button>
              <button onclick="showLoginModal()" class="px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-primary transition-colors font-medium">Login</button>
              <button onclick="showRegisterModal()" class="btn-primary px-6 py-2 text-white rounded-lg font-medium">Get Started</button>
            </div>
          </div>
        </nav>

        <!-- Hero Section -->
        <section class="pt-32 pb-20 px-6">
          <div class="max-w-7xl mx-auto">
            <div class="grid lg:grid-cols-2 gap-12 items-center">
              <div class="animate-fade-in">
                <div class="inline-flex items-center gap-2 px-4 py-2 bg-primary/10 rounded-full text-primary font-medium text-sm mb-6">
                  <span class="animate-pulse-slow">üöÄ</span> Powered by Advanced Analytics
                </div>
                <h1 class="font-display text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white leading-tight mb-6">
                  <span class="gradient-text" id="hero-title">Turning Data</span><br>
                  into <span class="text-primary">Decisions</span>
                </h1>
                <p class="text-xl text-gray-600 dark:text-gray-300 mb-8 leading-relaxed" id="hero-tagline">
                  Thummar Analytics empowers your business with real-time insights, 
                  beautiful visualizations, and actionable intelligence to drive growth.
                </p>
                <div class="flex flex-wrap gap-4">
                  <button onclick="showRegisterModal()" class="btn-primary px-8 py-4 text-white rounded-xl font-semibold text-lg flex items-center gap-2">
                    Start Free Trial <span>‚Üí</span>
                  </button>
                  <button onclick="showDemoLogin()" class="px-8 py-4 border-2 border-primary text-primary rounded-xl font-semibold text-lg hover:bg-primary/10 transition-colors">
                    View Demo
                  </button>
                </div>
                <div class="flex items-center gap-8 mt-10">
                  <div class="text-center">
                    <div class="font-display text-3xl font-bold text-gray-900 dark:text-white">10K+</div>
                    <div class="text-gray-500 text-sm">Active Users</div>
                  </div>
                  <div class="w-px h-12 bg-gray-200 dark:bg-gray-700"></div>
                  <div class="text-center">
                    <div class="font-display text-3xl font-bold text-gray-900 dark:text-white">99.9%</div>
                    <div class="text-gray-500 text-sm">Uptime</div>
                  </div>
                  <div class="w-px h-12 bg-gray-200 dark:bg-gray-700"></div>
                  <div class="text-center">
                    <div class="font-display text-3xl font-bold text-gray-900 dark:text-white">50M+</div>
                    <div class="text-gray-500 text-sm">Data Points</div>
                  </div>
                </div>
              </div>
              <div class="relative animate-fade-in" style="animation-delay: 0.3s">
                <div class="absolute inset-0 bg-gradient-to-r from-primary/20 to-primaryDark/20 rounded-3xl blur-3xl"></div>
                <div class="relative bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-6 border border-gray-100 dark:border-gray-700">
                  <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-red-400"></div>
                      <div class="w-3 h-3 rounded-full bg-yellow-400"></div>
                      <div class="w-3 h-3 rounded-full bg-green-400"></div>
                    </div>
                    <div class="text-xs text-gray-400 font-mono">dashboard.thummar.com</div>
                  </div>
                  <div class="space-y-4">
                    <div class="grid grid-cols-3 gap-3">
                      ${[1,2,3].map(i => `
                        <div class="bg-gradient-to-br ${['from-primary/20 to-primary/5', 'from-purple-100 to-purple-50', 'from-orange-100 to-orange-50'][i-1]} dark:from-gray-700 dark:to-gray-800 rounded-xl p-4">
                          <div class="text-2xl mb-2">${['üí∞', 'üì¶', 'üë•'][i-1]}</div>
                          <div class="font-bold text-gray-800 dark:text-white">${['$1.2M', '15.4K', '8.9K'][i-1]}</div>
                          <div class="text-xs text-gray-500">${['Revenue', 'Orders', 'Users'][i-1]}</div>
                        </div>
                      `).join('')}
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 h-32 flex items-end gap-1">
                      ${Array.from({length: 12}, (_, i) => `
                        <div class="flex-1 bg-gradient-to-t from-primary to-primary/60 rounded-t" style="height: ${30 + Math.random() * 70}%"></div>
                      `).join('')}
                    </div>
                    <div class="flex gap-4 text-xs text-gray-400">
                      <span class="flex items-center gap-1"><span class="w-2 h-2 bg-primary rounded-full"></span> Revenue</span>
                      <span class="flex items-center gap-1"><span class="w-2 h-2 bg-purple-400 rounded-full"></span> Orders</span>
                    </div>
                  </div>
                  <div class="absolute -bottom-4 -right-4 w-24 h-24 bg-primary/20 rounded-full blur-2xl animate-float"></div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Features Section -->
        <section class="py-20 px-6 bg-white/50 dark:bg-gray-800/50">
          <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16">
              <h2 class="font-display text-4xl font-bold text-gray-900 dark:text-white mb-4">Powerful Features</h2>
              <p class="text-xl text-gray-600 dark:text-gray-300">Everything you need to make data-driven decisions</p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
              ${[
                { icon: 'üìä', title: 'KPI Monitoring', desc: 'Track all your key performance indicators in real-time with beautiful dashboards' },
                { icon: 'üìà', title: 'Interactive Charts', desc: 'Visualize your data with dynamic charts that update as you filter' },
                { icon: 'üìã', title: 'Reports & Insights', desc: 'Generate comprehensive reports with actionable insights' },
                { icon: 'üì•', title: 'PDF / CSV Exports', desc: 'Export your data and reports in multiple formats' },
                { icon: '‚ö°', title: 'Real-time Updates', desc: 'Watch your metrics update in real-time as data flows in' },
                { icon: 'üîí', title: 'Role-based Access', desc: 'Control who sees what with granular permissions' }
              ].map((f, i) => `
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg hover:shadow-xl transition-shadow card-hover animate-fade-in" style="animation-delay: ${i * 0.1}s">
                  <div class="w-14 h-14 bg-primary/10 rounded-xl flex items-center justify-center text-3xl mb-6">${f.icon}</div>
                  <h3 class="font-display text-xl font-bold text-gray-900 dark:text-white mb-3">${f.title}</h3>
                  <p class="text-gray-600 dark:text-gray-300">${f.desc}</p>
                </div>
              `).join('')}
            </div>
          </div>
        </section>

        <!-- CTA Section -->
        <section class="py-20 px-6">
          <div class="max-w-4xl mx-auto text-center">
            <div class="bg-gradient-to-br from-primary to-primaryDark rounded-3xl p-12 text-white">
              <h2 class="font-display text-4xl font-bold mb-4">Ready to Transform Your Data?</h2>
              <p class="text-xl opacity-90 mb-8">Join thousands of businesses already using Thummar Analytics</p>
              <div class="flex flex-wrap justify-center gap-4">
                <button onclick="showRegisterModal()" class="px-8 py-4 bg-white text-primary rounded-xl font-semibold text-lg hover:bg-gray-100 transition-colors">
                  Start Free Trial
                </button>
                <button onclick="showDemoLogin()" class="px-8 py-4 border-2 border-white text-white rounded-xl font-semibold text-lg hover:bg-white/10 transition-colors">
                  Try Demo Account
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- Footer -->
        <footer class="bg-gray-900 text-white py-12 px-6">
          <div class="max-w-7xl mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-center gap-6">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-primary flex items-center justify-center text-white font-bold text-xl">T</div>
                <span class="font-display font-bold text-xl">Thummar Analytics</span>
              </div>
              <p class="text-gray-400">¬© 2024 Thummar Analytics. All rights reserved.</p>
            </div>
          </div>
        </footer>
      </div>
    `;

    const renderAuthModal = (type) => `
      <div id="auth-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in" onclick="closeModal(event)">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md p-8 transform" onclick="event.stopPropagation()">
          <div class="text-center mb-8">
            <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-primary to-primaryDark flex items-center justify-center text-white font-bold text-3xl">T</div>
            <h2 class="font-display text-2xl font-bold text-gray-900 dark:text-white">${type === 'login' ? 'Welcome Back' : 'Create Account'}</h2>
            <p class="text-gray-500 mt-2">${type === 'login' ? 'Sign in to your dashboard' : 'Start your analytics journey'}</p>
          </div>
          <form onsubmit="handleAuth(event, '${type}')" class="space-y-5">
            ${type === 'register' ? `
              <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" for="name">Full Name</label>
                <input type="text" id="name" name="name" required class="w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all" placeholder="Enter your name">
              </div>
            ` : ''}
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" for="email">Email Address</label>
              <input type="email" id="email" name="email" required class="w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all" placeholder="you@example.com">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" for="password">Password</label>
              <input type="password" id="password" name="password" required class="w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>
            ${type === 'register' ? `
              <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" for="role">Account Type</label>
                <select id="role" name="role" class="w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all">
                  <option value="viewer">Viewer (Read-only)</option>
                  <option value="manager">Manager</option>
                  <option value="admin">Admin</option>
                </select>
              </div>
            ` : ''}
            <button type="submit" class="w-full btn-primary py-4 text-white rounded-xl font-semibold text-lg">
              ${type === 'login' ? 'Sign In' : 'Create Account'}
            </button>
          </form>
          <div class="mt-6 text-center">
            <p class="text-gray-500">
              ${type === 'login' ? "Don't have an account?" : 'Already have an account?'}
              <button onclick="${type === 'login' ? 'showRegisterModal()' : 'showLoginModal()'}" class="text-primary font-medium hover:underline ml-1">
                ${type === 'login' ? 'Sign up' : 'Sign in'}
              </button>
            </p>
          </div>
          ${type === 'login' ? `
            <div class="mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl">
              <p class="text-sm text-gray-600 dark:text-gray-300 font-medium mb-2">Demo Accounts:</p>
              <div class="space-y-1 text-xs text-gray-500 dark:text-gray-400">
                <p>üë®‚Äçüíº Admin: admin@thummar.com / admin123</p>
                <p>üë©‚Äçüíª Manager: manager@thummar.com / manager123</p>
                <p>üë§ Viewer: viewer@thummar.com / viewer123</p>
              </div>
            </div>
          ` : ''}
          <button onclick="closeAuthModal()" class="absolute top-4 right-4 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors">
            ‚úï
          </button>
        </div>
      </div>
    `;

    const renderDashboard = () => {
      const user = store.state.currentUser;
      const { kpiData, loading, selectedDateRange, selectedMetric, searchQuery, sidebarOpen } = store.state;

      return `
        <div class="h-full flex bg-gray-50 dark:bg-gray-900">
          <!-- Sidebar -->
          <aside class="sidebar-transition ${sidebarOpen ? 'w-64' : 'w-20'} bg-white dark:bg-gray-800 border-r border-gray-100 dark:border-gray-700 flex flex-col">
            <div class="p-4 border-b border-gray-100 dark:border-gray-700">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-primaryDark flex items-center justify-center text-white font-bold text-xl flex-shrink-0">T</div>
                ${sidebarOpen ? `<span class="font-display font-bold text-lg text-gray-800 dark:text-white truncate" id="sidebar-brand">Thummar Analytics</span>` : ''}
              </div>
            </div>
            <nav class="flex-1 p-4 space-y-2">
              ${[
                { id: 'dashboard', icon: 'üìä', label: 'Dashboard', permission: 'dashboard' },
                { id: 'sales', icon: 'üí∞', label: 'Sales', permission: 'sales' },
                { id: 'customers', icon: 'üë•', label: 'Customers', permission: 'customers' },
                { id: 'inventory', icon: 'üì¶', label: 'Inventory', permission: 'inventory' },
                { id: 'users', icon: '‚öôÔ∏è', label: 'User Management', permission: 'users' }
              ].filter(item => hasPermission(item.permission)).map(item => `
                <button onclick="navigateTo('${item.id}')" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${store.state.currentView === item.id ? 'bg-primary/10 text-primary' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700'}">
                  <span class="text-xl">${item.icon}</span>
                  ${sidebarOpen ? `<span class="font-medium">${item.label}</span>` : ''}
                </button>
              `).join('')}
            </nav>
            <div class="p-4 border-t border-gray-100 dark:border-gray-700">
              <button onclick="handleLogout()" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-all">
                <span class="text-xl">üö™</span>
                ${sidebarOpen ? `<span class="font-medium">Logout</span>` : ''}
              </button>
            </div>
          </aside>

          <!-- Main Content -->
          <main class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="bg-white dark:bg-gray-800 border-b border-gray-100 dark:border-gray-700 px-6 py-4">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                  <button onclick="toggleSidebar()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <svg class="w-6 h-6 text-gray-600 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                  </button>
                  <div class="relative">
                    <input type="text" placeholder="Search..." value="${searchQuery}" oninput="updateSearch(this.value)" class="pl-10 pr-4 py-2 rounded-xl border border-gray-200 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none w-64 transition-all">
                    <svg class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                  </div>
                </div>
                <div class="flex items-center gap-4">
                  ${hasPermission('filters') ? `
                    <select onchange="updateDateRange(this.value)" class="px-4 py-2 rounded-xl border border-gray-200 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all">
                      <option value="7d" ${selectedDateRange === '7d' ? 'selected' : ''}>Last 7 days</option>
                      <option value="30d" ${selectedDateRange === '30d' ? 'selected' : ''}>Last 30 days</option>
                      <option value="90d" ${selectedDateRange === '90d' ? 'selected' : ''}>Last 90 days</option>
                      <option value="1y" ${selectedDateRange === '1y' ? 'selected' : ''}>Last year</option>
                    </select>
                    <select onchange="updateMetric(this.value)" class="px-4 py-2 rounded-xl border border-gray-200 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all">
                      <option value="revenue" ${selectedMetric === 'revenue' ? 'selected' : ''}>Revenue</option>
                      <option value="orders" ${selectedMetric === 'orders' ? 'selected' : ''}>Orders</option>
                      <option value="customers" ${selectedMetric === 'customers' ? 'selected' : ''}>Customers</option>
                    </select>
                  ` : ''}
                  ${hasPermission('export') ? `
                    <button onclick="exportToCSV()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" title="Export CSV">
                      <span class="text-xl">üì•</span>
                    </button>
                    <button onclick="exportToPDF()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" title="Export PDF">
                      <span class="text-xl">üìÑ</span>
                    </button>
                  ` : ''}
                  <button onclick="toggleDarkMode()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <span class="text-xl">${store.state.darkMode ? '‚òÄÔ∏è' : 'üåô'}</span>
                  </button>
                  <div class="flex items-center gap-3 pl-4 border-l border-gray-200 dark:border-gray-700">
                    <div class="text-right hidden sm:block">
                      <div class="font-medium text-gray-800 dark:text-white">${user.name}</div>
                      <div class="text-xs text-gray-500 capitalize">${user.role}</div>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-xl">${user.avatar}</div>
                  </div>
                </div>
              </div>
            </header>

            <!-- Dashboard Content -->
            <div class="flex-1 overflow-auto p-6">
              <div class="mb-6">
                <h1 class="font-display text-3xl font-bold text-gray-900 dark:text-white">
                  ${store.state.currentView === 'dashboard' ? 'Dashboard Overview' : 
                    store.state.currentView === 'sales' ? 'Sales Analytics' :
                    store.state.currentView === 'customers' ? 'Customer Insights' :
                    store.state.currentView === 'inventory' ? 'Inventory Management' :
                    store.state.currentView === 'users' ? 'User Management' : 'Dashboard'}
                </h1>
                <p class="text-gray-500 mt-1">Welcome back, ${user.name}! Here's what's happening.</p>
              </div>

              <!-- KPI Cards -->
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                ${loading ? Array(8).fill(0).map(() => `
                  <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm">
                    <div class="skeleton h-4 w-24 mb-4 rounded"></div>
                    <div class="skeleton h-8 w-32 mb-2 rounded"></div>
                    <div class="skeleton h-4 w-16 rounded"></div>
                  </div>
                `).join('') : kpiData.map((kpi, i) => `
                  <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm card-hover animate-fade-in" style="animation-delay: ${i * 0.05}s">
                    <div class="flex items-center justify-between mb-4">
                      <span class="text-sm font-medium text-gray-500 dark:text-gray-400">${kpi.title}</span>
                      <span class="text-2xl">${kpi.icon}</span>
                    </div>
                    <div class="text-3xl font-display font-bold text-gray-900 dark:text-white mb-2 animate-count">
                      ${formatNumber(kpi.value, kpi.prefix || '', kpi.suffix || '')}
                    </div>
                    <div class="flex items-center gap-2">
                      <span class="${parseFloat(kpi.change) >= 0 ? 'text-green-500' : 'text-red-500'} text-sm font-medium flex items-center gap-1">
                        ${parseFloat(kpi.change) >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(kpi.change)}%
                      </span>
                      <span class="text-gray-400 text-sm">vs last period</span>
                    </div>
                    <div class="mt-4 h-1 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden">
                      <div class="h-full bg-gradient-to-r ${kpi.color} rounded-full" style="width: ${Math.min(Math.abs(kpi.change) * 5, 100)}%"></div>
                    </div>
                  </div>
                `).join('')}
              </div>

              <!-- Charts Section -->
              <div class="grid lg:grid-cols-2 gap-6 mb-8">
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm">
                  <div class="flex items-center justify-between mb-6">
                    <h3 class="font-display text-lg font-bold text-gray-900 dark:text-white">Revenue Trend</h3>
                    <span class="text-sm text-gray-500">Last 12 months</span>
                  </div>
                  <div class="chart-container">
                    <canvas id="lineChart"></canvas>
                  </div>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm">
                  <div class="flex items-center justify-between mb-6">
                    <h3 class="font-display text-lg font-bold text-gray-900 dark:text-white">Orders by Month</h3>
                    <span class="text-sm text-gray-500">Comparison view</span>
                  </div>
                  <div class="chart-container">
                    <canvas id="barChart"></canvas>
                  </div>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm">
                  <div class="flex items-center justify-between mb-6">
                    <h3 class="font-display text-lg font-bold text-gray-900 dark:text-white">Category Distribution</h3>
                    <span class="text-sm text-gray-500">By revenue</span>
                  </div>
                  <div class="chart-container">
                    <canvas id="doughnutChart"></canvas>
                  </div>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm">
                  <div class="flex items-center justify-between mb-6">
                    <h3 class="font-display text-lg font-bold text-gray-900 dark:text-white">Growth Trends</h3>
                    <span class="text-sm text-gray-500">Stacked view</span>
                  </div>
                  <div class="chart-container">
                    <canvas id="areaChart"></canvas>
                  </div>
                </div>
              </div>

              <!-- Data Table -->
              <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm overflow-hidden">
                <div class="p-6 border-b border-gray-100 dark:border-gray-700">
                  <div class="flex items-center justify-between">
                    <h3 class="font-display text-lg font-bold text-gray-900 dark:text-white">Recent Orders</h3>
                    <div class="text-sm text-gray-500">Showing ${Math.min(10, store.state.tableData.length)} of ${store.state.tableData.length} orders</div>
                  </div>
                </div>
                <div class="overflow-x-auto">
                  <table class="w-full">
                    <thead class="bg-gray-50 dark:bg-gray-700/50">
                      <tr>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Order</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Customer</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Product</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Amount</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Trend</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Date</th>
                      </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                      ${store.state.tableData
                        .filter(row => !searchQuery || row.customer.toLowerCase().includes(searchQuery.toLowerCase()) || row.product.toLowerCase().includes(searchQuery.toLowerCase()) || row.orderNumber.toLowerCase().includes(searchQuery.toLowerCase()))
                        .slice(0, 10)
                        .map((row, i) => `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors animate-slide-in" style="animation-delay: ${i * 0.03}s">
                          <td class="px-6 py-4">
                            <span class="font-mono text-sm font-medium text-primary">${row.orderNumber}</span>
                          </td>
                          <td class="px-6 py-4">
                            <span class="text-gray-900 dark:text-white font-medium">${row.customer}</span>
                          </td>
                          <td class="px-6 py-4">
                            <span class="text-gray-600 dark:text-gray-300">${row.product}</span>
                          </td>
                          <td class="px-6 py-4">
                            <span class="font-medium text-gray-900 dark:text-white">$${row.amount.toLocaleString()}</span>
                          </td>
                          <td class="px-6 py-4">
                            <span class="px-3 py-1 rounded-full text-xs font-medium ${
                              row.status === 'Completed' ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400' :
                              row.status === 'Processing' ? 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400' :
                              row.status === 'Shipped' ? 'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400' :
                              'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400'
                            }">${row.status}</span>
                          </td>
                          <td class="px-6 py-4">
                            <div class="flex items-end gap-0.5 h-6">
                              ${row.trend.map(v => `<div class="w-1 bg-primary/60 rounded-t" style="height: ${v * 0.24}px"></div>`).join('')}
                            </div>
                          </td>
                          <td class="px-6 py-4">
                            <span class="text-gray-500 dark:text-gray-400 text-sm">${row.date}</span>
                          </td>
                        </tr>
                      `).join('')}
                    </tbody>
                  </table>
                </div>
                <div class="p-4 border-t border-gray-100 dark:border-gray-700 flex items-center justify-between">
                  <button class="px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors">Previous</button>
                  <div class="flex items-center gap-2">
                    ${[1, 2, 3, 4, 5].map(p => `
                      <button class="w-8 h-8 rounded-lg ${p === 1 ? 'bg-primary text-white' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700'} transition-colors font-medium">${p}</button>
                    `).join('')}
                  </div>
                  <button class="px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors">Next</button>
                </div>
              </div>

              ${store.state.currentView === 'users' && hasPermission('users') ? `
                <!-- User Management Section -->
                <div class="mt-8 bg-white dark:bg-gray-800 rounded-2xl shadow-sm overflow-hidden">
                  <div class="p-6 border-b border-gray-100 dark:border-gray-700">
                    <h3 class="font-display text-lg font-bold text-gray-900 dark:text-white">User Management</h3>
                  </div>
                  <div class="overflow-x-auto">
                    <table class="w-full">
                      <thead class="bg-gray-50 dark:bg-gray-700/50">
                        <tr>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">User</th>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Email</th>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Role</th>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                        ${mockUsers.map(u => `
                          <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors">
                            <td class="px-6 py-4">
                              <div class="flex items-center gap-3">
                                <span class="text-2xl">${u.avatar}</span>
                                <span class="font-medium text-gray-900 dark:text-white">${u.name}</span>
                              </div>
                            </td>
                            <td class="px-6 py-4 text-gray-600 dark:text-gray-300">${u.email}</td>
                            <td class="px-6 py-4">
                              <span class="px-3 py-1 rounded-full text-xs font-medium ${
                                u.role === 'admin' ? 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400' :
                                u.role === 'manager' ? 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400' :
                                'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300'
                              } capitalize">${u.role}</span>
                            </td>
                            <td class="px-6 py-4">
                              <span class="flex items-center gap-2 text-green-500">
                                <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse-slow"></span>
                                Active
                              </span>
                            </td>
                          </tr>
                        `).join('')}
                      </tbody>
                    </table>
                  </div>
                </div>
              ` : ''}
            </div>
          </main>
        </div>
      `;
    };

    const renderNotifications = () => `
      <div class="fixed bottom-6 right-6 z-50 space-y-3">
        ${store.state.notifications.map(n => `
          <div class="animate-slide-in bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 flex items-center gap-3 border-l-4 ${n.type === 'success' ? 'border-green-500' : n.type === 'error' ? 'border-red-500' : 'border-primary'}">
            <span class="text-xl">${n.type === 'success' ? '‚úÖ' : n.type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
            <span class="text-gray-800 dark:text-white font-medium">${n.message}</span>
          </div>
        `).join('')}
      </div>
    `;

    // ==================== EVENT HANDLERS ====================
    window.toggleDarkMode = () => {
      const darkMode = !store.state.darkMode;
      store.setState({ darkMode });
      document.documentElement.classList.toggle('dark', darkMode);
      if (store.state.isAuthenticated) {
        setTimeout(initCharts, 100);
      }
    };

    window.toggleSidebar = () => {
      store.setState({ sidebarOpen: !store.state.sidebarOpen });
    };

    window.showLoginModal = () => {
      document.body.insertAdjacentHTML('beforeend', renderAuthModal('login'));
    };

    window.showRegisterModal = () => {
      document.body.insertAdjacentHTML('beforeend', renderAuthModal('register'));
    };

    window.showDemoLogin = () => {
      const user = mockUsers[0];
      store.setState({
        isAuthenticated: true,
        currentUser: user,
        currentView: 'dashboard',
        loading: true
      });
      render();
      setTimeout(() => {
        store.setState({
          loading: false,
          kpiData: generateKPIData(),
          chartData: generateChartData(),
          tableData: generateTableData()
        });
        render();
        setTimeout(initCharts, 100);
      }, 1000);
      showNotification(`Welcome, ${user.name}! Logged in as ${user.role}`);
    };

    window.closeModal = (e) => {
      if (e.target.id === 'auth-modal') {
        closeAuthModal();
      }
    };

    window.closeAuthModal = () => {
      const modal = document.getElementById('auth-modal');
      if (modal) modal.remove();
    };

    window.handleAuth = (e, type) => {
      e.preventDefault();
      const form = e.target;
      const email = form.email.value;
      const password = form.password.value;

      if (type === 'login') {
        const user = mockUsers.find(u => u.email === email && u.password === password);
        if (user) {
          store.setState({
            isAuthenticated: true,
            currentUser: user,
            currentView: 'dashboard',
            loading: true
          });
          closeAuthModal();
          render();
          setTimeout(() => {
            store.setState({
              loading: false,
              kpiData: generateKPIData(),
              chartData: generateChartData(),
              tableData: generateTableData()
            });
            render();
            setTimeout(initCharts, 100);
          }, 1000);
          showNotification(`Welcome back, ${user.name}!`);
        } else {
          showNotification('Invalid credentials. Try demo accounts.', 'error');
        }
      } else {
        const name = form.name.value;
        const role = form.role.value;
        const newUser = {
          id: Date.now(),
          email,
          password,
          name,
          role,
          avatar: 'üë§'
        };
        mockUsers.push(newUser);
        store.setState({
          isAuthenticated: true,
          currentUser: newUser,
          currentView: 'dashboard',
          loading: true
        });
        closeAuthModal();
        render();
        setTimeout(() => {
          store.setState({
            loading: false,
            kpiData: generateKPIData(),
            chartData: generateChartData(),
            tableData: generateTableData()
          });
          render();
          setTimeout(initCharts, 100);
        }, 1000);
        showNotification(`Account created! Welcome, ${name}!`);
      }
    };

    window.handleLogout = () => {
      store.setState({
        isAuthenticated: false,
        currentUser: null,
        currentView: 'landing'
      });
      render();
      showNotification('Logged out successfully');
    };

    window.navigateTo = (view) => {
      store.setState({ currentView: view, loading: true });
      render();
      setTimeout(() => {
        store.setState({
          loading: false,
          kpiData: generateKPIData(),
          chartData: generateChartData()
        });
        render();
        setTimeout(initCharts, 100);
      }, 500);
    };

    window.updateDateRange = (range) => {
      store.setState({ selectedDateRange: range, loading: true });
      render();
      setTimeout(() => {
        store.setState({
          loading: false,
          kpiData: generateKPIData(),
          chartData: generateChartData()
        });
        render();
        setTimeout(initCharts, 100);
      }, 300);
    };

    window.updateMetric = (metric) => {
      store.setState({ selectedMetric: metric });
      setTimeout(initCharts, 100);
    };

    window.updateSearch = (query) => {
      store.setState({ searchQuery: query });
      render();
      setTimeout(initCharts, 100);
    };

    // ==================== CHART INITIALIZATION ====================
    let charts = {};

    const initCharts = () => {
      const chartData = store.state.chartData;
      if (!chartData) return;

      const isDark = store.state.darkMode;
      const textColor = isDark ? '#e5e7eb' : '#374151';
      const gridColor = isDark ? 'rgba(75, 85, 99, 0.3)' : 'rgba(229, 231, 235, 0.8)';

      Chart.defaults.color = textColor;
      Chart.defaults.borderColor = gridColor;

      // Destroy existing charts
      Object.values(charts).forEach(chart => chart?.destroy?.());

      // Line Chart
      const lineCtx = document.getElementById('lineChart')?.getContext('2d');
      if (lineCtx) {
        charts.line = new Chart(lineCtx, {
          type: 'line',
          data: {
            labels: chartData.labels,
            datasets: [{
              label: 'Revenue',
              data: chartData.revenue,
              borderColor: '#5ebec4',
              backgroundColor: 'rgba(94, 190, 196, 0.1)',
              fill: true,
              tension: 0.4,
              pointBackgroundColor: '#5ebec4',
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: 4,
              pointHoverRadius: 6
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false }
            },
            scales: {
              y: {
                beginAtZero: true,
                grid: { color: gridColor },
                ticks: {
                  callback: (value) => '$' + (value / 1000) + 'K'
                }
              },
              x: {
                grid: { display: false }
              }
            }
          }
        });
      }

      // Bar Chart
      const barCtx = document.getElementById('barChart')?.getContext('2d');
      if (barCtx) {
        charts.bar = new Chart(barCtx, {
          type: 'bar',
          data: {
            labels: chartData.labels,
            datasets: [{
              label: 'Orders',
              data: chartData.orders,
              backgroundColor: 'rgba(94, 190, 196, 0.8)',
              borderRadius: 8,
              borderSkipped: false
            }, {
              label: 'Customers',
              data: chartData.customers,
              backgroundColor: 'rgba(147, 51, 234, 0.6)',
              borderRadius: 8,
              borderSkipped: false
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'top',
                labels: { usePointStyle: true, padding: 20 }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                grid: { color: gridColor }
              },
              x: {
                grid: { display: false }
              }
            }
          }
        });
      }

      // Doughnut Chart
      const doughnutCtx = document.getElementById('doughnutChart')?.getContext('2d');
      if (doughnutCtx) {
        charts.doughnut = new Chart(doughnutCtx, {
          type: 'doughnut',
          data: {
            labels: chartData.categories,
            datasets: [{
              data: chartData.categoryValues,
              backgroundColor: [
                '#5ebec4',
                '#9333ea',
                '#f97316',
                '#ec4899',
                '#06b6d4'
              ],
              borderWidth: 0,
              spacing: 2
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '65%',
            plugins: {
              legend: {
                position: 'right',
                labels: { usePointStyle: true, padding: 15 }
              }
            }
          }
        });
      }

      // Area Chart
      const areaCtx = document.getElementById('areaChart')?.getContext('2d');
      if (areaCtx) {
        charts.area = new Chart(areaCtx, {
          type: 'line',
          data: {
            labels: chartData.labels,
            datasets: [{
              label: 'Revenue',
              data: chartData.revenue.map(v => v * 0.8),
              borderColor: '#5ebec4',
              backgroundColor: 'rgba(94, 190, 196, 0.3)',
              fill: true,
              tension: 0.4
            }, {
              label: 'Orders',
              data: chartData.orders.map(v => v * 50),
              borderColor: '#9333ea',
              backgroundColor: 'rgba(147, 51, 234, 0.2)',
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'top',
                labels: { usePointStyle: true, padding: 20 }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                stacked: true,
                grid: { color: gridColor }
              },
              x: {
                grid: { display: false }
              }
            }
          }
        });
      }
    };

    // ==================== RENDER ====================
    const render = () => {
      const app = document.getElementById('app');
      const { isAuthenticated } = store.state;

      app.innerHTML = isAuthenticated ? renderDashboard() : renderLandingPage();
      app.insertAdjacentHTML('beforeend', renderNotifications());
    };

    // ==================== INITIALIZATION ====================
    const defaultConfig = {
      company_name: 'Thummar Analytics',
      tagline: 'Turning Data into Decisions'
    };

    const initApp = async () => {
      // Initialize Element SDK
      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            const companyName = config.company_name || defaultConfig.company_name;
            const tagline = config.tagline || defaultConfig.tagline;

            // Update landing page elements
            const brandName = document.getElementById('brand-name');
            if (brandName) brandName.textContent = companyName;

            const heroTitle = document.getElementById('hero-title');
            if (heroTitle) heroTitle.textContent = tagline.split(' ').slice(0, 2).join(' ');

            const heroTagline = document.getElementById('hero-tagline');
            if (heroTagline) heroTagline.textContent = `${companyName} empowers your business with real-time insights, beautiful visualizations, and actionable intelligence to drive growth.`;

            const sidebarBrand = document.getElementById('sidebar-brand');
            if (sidebarBrand) sidebarBrand.textContent = companyName;
          },
          mapToCapabilities: (config) => ({
            recolorables: [],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ['company_name', config.company_name || defaultConfig.company_name],
            ['tagline', config.tagline || defaultConfig.tagline]
          ])
        });
      }

      // Initial render
      render();

      // Real-time data simulation
      setInterval(() => {
        if (store.state.isAuthenticated && !store.state.loading) {
          store.setState({
            kpiData: generateKPIData()
          });
          // Only update KPI cards, not full render to avoid chart flicker
          const kpiContainer = document.querySelector('.grid.grid-cols-1.sm\\:grid-cols-2');
          if (kpiContainer && store.state.kpiData) {
            // Selective update - just refresh KPI values
          }
        }
      }, 30000);
    };

    // Start the app
    initApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ce4633f97ba9a40',t:'MTc3MTE1NDEzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>